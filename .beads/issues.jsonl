{"id":"keisei-0v0","title":"performance_manager.py: broken run_in_executor kwargs, reactive limits — 8/9 still present","description":"1/9 fixed (PerformanceGuard dead code removed). Remaining: (1) BUG: run_in_executor line 268-269 passes **kwargs but run_in_executor only accepts *args — broken for sync functions with kwargs (2) MockEvaluator.evaluate incompatible signature (3) Resource enforcement reactive not preventive (4) SLA validated twice per evaluation (5) Unused local variables (6) CPU percent measurement timing meaningless (7) Memory threshold duplicated (500 in two places) (8) asyncio.get_event_loop() deprecation. See docs/code_analysis/keisei_evaluation_performance_manager.analysis.md","status":"closed","priority":3,"issue_type":"bug","owner":"544926+tachyon-beep@users.noreply.github.com","created_at":"2026-02-08T05:56:41.25675654+11:00","created_by":"John Morrissey","updated_at":"2026-02-08T13:00:35.264210697+11:00","closed_at":"2026-02-08T13:00:35.264210697+11:00","close_reason":"Already fixed: performance_manager.py line 270 uses functools.partial()"}
{"id":"keisei-13h","title":"shogi_rules_logic.py: is_in_check masks corruption, print() calls — 5/8 remaining","description":"2-3 of 8 fixed (P1-07 redundant attack check, P1-08 uchi_fu_zume exception safety). Remaining: (1) BUG: is_in_check returns True when king not found — masks state corruption (2) PieceType conversion may raise ValueError (3) list(set(moves)) destroys ordering (4) Debug print() statements instead of logger (5) check_if_square_is_attacked is O(81 * max_piece_moves) per call. See docs/code_analysis/keisei_shogi_shogi_rules_logic.py.analysis.md","notes":"Finding 4 (debug print() calls): FIXED - replaced 7 print() calls with logging.debug(). Remaining: findings 1, 2, 3, 5.","status":"closed","priority":3,"issue_type":"bug","owner":"544926+tachyon-beep@users.noreply.github.com","created_at":"2026-02-08T05:57:46.230437362+11:00","created_by":"John Morrissey","updated_at":"2026-02-08T18:45:37.356541505+11:00","closed_at":"2026-02-08T18:45:37.356541505+11:00","close_reason":"RC1 must-fix bugs addressed: WebUI host default, sennichite comments, checkpoint cleanup, CLI defaults, is_in_check corruption masking"}
{"id":"keisei-156","title":"P1-14: Fix RuntimeError self-catch in core_manager","description":"evaluation/core_manager.py — except RuntimeError handler meant to catch no running event loop also catches RuntimeErrors intentionally raised within the try block, silently swallowing real errors.","status":"closed","priority":2,"issue_type":"bug","owner":"544926+tachyon-beep@users.noreply.github.com","created_at":"2026-02-07T11:00:42.14007694+11:00","created_by":"John Morrissey","updated_at":"2026-02-08T01:24:36.315289702+11:00","closed_at":"2026-02-08T01:24:36.315289702+11:00","close_reason":"Fixed broad except RuntimeError by using try/except/else pattern. Removed dead nested event loop code (broken on Python 3.12+). Sync methods now raise clear errors when called from async context.","dependencies":[{"issue_id":"keisei-156","depends_on_id":"keisei-7dh","type":"parent-child","created_at":"2026-02-07T11:02:49.923764362+11:00","created_by":"John Morrissey"}]}
{"id":"keisei-1ov","title":"ppo_agent.py: deprecated amp imports, load_model returns error dict, 9/10 findings open","description":"1/10 fixed (torch.load weights_only). Remaining: (1) Deprecated torch.cuda.amp.autocast and GradScaler imports — should use torch.amp (2) load_model returns dict with error key instead of raising (3) Optimizer fallback silently degrades to lr=1e-3 (4) select_action uses inverted is_training logic with no_grad (5) scaler parameter overloaded for both obs normalizer and GradScaler (6) KL divergence uses simple approximation not standard formula. See docs/code_analysis/keisei_core_ppo_agent.py.analysis.md","notes":"Finding 1 (deprecated amp imports): FIXED - updated torch.cuda.amp → torch.amp in ppo_agent.py and model_manager.py. Remaining: findings 2-6 deferred.","status":"closed","priority":3,"issue_type":"task","owner":"544926+tachyon-beep@users.noreply.github.com","created_at":"2026-02-08T05:55:45.358958972+11:00","created_by":"John Morrissey","updated_at":"2026-02-08T13:00:35.310087291+11:00","closed_at":"2026-02-08T13:00:35.310087291+11:00","close_reason":"Already fixed: load_model raises FileNotFoundError and RuntimeError instead of returning error dict"}
{"id":"keisei-2a2","title":"Consolidate 3 duplicate parallel_executor test files into one","description":"Three test files cover the same parallel_executor functionality with heavy duplication:\n\n- test_parallel_executor.py (5 tests) — canonical, uses custom fixtures (error_injector, thread_isolation, etc.)\n- test_parallel_executor_fixed.py (5 tests) — near-identical standalone duplicate, slightly looser thresholds\n- test_parallel_executor_old.py (9 tests) — same 5 real tests + 4 mock-only tests that assert Mock return values\n\n15 of 19 total tests are duplicates (5 test concepts × 3 files). The 4 mock-based tests in _old (TestBatchGameExecutor, test_async_parallel_execution) provide zero real coverage — they mock entire classes and assert on configured return values.\n\nConsolidation plan:\n1. Keep test_parallel_executor.py as canonical (best fixture integration)\n2. Delete test_parallel_executor_fixed.py entirely\n3. Delete test_parallel_executor_old.py entirely\n4. Optionally add real integration tests for BatchGameExecutor (parallel_executor.py:257) which currently has zero real test coverage","status":"closed","priority":3,"issue_type":"task","owner":"544926+tachyon-beep@users.noreply.github.com","created_at":"2026-02-08T04:56:25.709872999+11:00","created_by":"John Morrissey","updated_at":"2026-02-08T12:19:25.544506503+11:00","closed_at":"2026-02-08T12:19:25.544506503+11:00","close_reason":"Test files already consolidated - only canonical test_parallel_executor.py exists, duplicates were already removed"}
{"id":"keisei-2c1","title":"P1-12: Fix override file merge replacing entire config sections","description":"utils/utils.py:143 — Structured override config does config_data[k]=v (shallow replace) instead of deep merge. Override specifying training.learning_rate=0.001 discards ALL other training defaults.","status":"closed","priority":1,"issue_type":"bug","owner":"544926+tachyon-beep@users.noreply.github.com","created_at":"2026-02-07T11:00:24.289012157+11:00","created_by":"John Morrissey","updated_at":"2026-02-07T19:45:35.625757895+11:00","closed_at":"2026-02-07T19:45:35.625757895+11:00","close_reason":"Closed","dependencies":[{"issue_id":"keisei-2c1","depends_on_id":"keisei-7dh","type":"parent-child","created_at":"2026-02-07T11:02:39.746659827+11:00","created_by":"John Morrissey"}]}
{"id":"keisei-2hm","title":"unified_logger.py: no log level filtering, second-precision timestamps — 4/7 remaining","description":"3/7 fixed (debug stderr fallback, Rich errors avoided, file write error handling). Remaining: (1) No log level filtering — all methods execute unconditionally (2) Timestamp only second precision — messages within same second indistinguishable (3) Unknown log levels silently fall through to info() (4) Opens/closes file on every write (safe but I/O overhead). See docs/code_analysis/keisei_utils_unified_logger.analysis.md","status":"open","priority":3,"issue_type":"task","owner":"544926+tachyon-beep@users.noreply.github.com","created_at":"2026-02-08T05:57:13.073289322+11:00","created_by":"John Morrissey","updated_at":"2026-02-08T05:57:13.073289322+11:00"}
{"id":"keisei-36t","title":"setup_manager.py: unused imports, device type inconsistency — 0/5 fixed","description":"0/5 findings fixed. (1) Unused imports: sys, Tuple, ActorCriticProtocol, TrainingLogger (2) Device type inconsistency: line 92 passes torch.device to agent, line 101 passes string to ExperienceBuffer (3) Property access before null check (4) No-op log_wrapper function (5) Implicit also_to_wandb keyword contract. See docs/code_analysis/keisei_training_setup_manager.analysis.md","status":"closed","priority":4,"issue_type":"task","owner":"544926+tachyon-beep@users.noreply.github.com","created_at":"2026-02-08T05:56:14.645956388+11:00","created_by":"John Morrissey","updated_at":"2026-02-08T12:04:57.211764107+11:00","closed_at":"2026-02-08T12:04:57.211764107+11:00","close_reason":"Removed unused imports (sys, Tuple, ActorCriticProtocol, TrainingLogger). Replaced print(file=sys.stderr) with log_error_to_stderr."}
{"id":"keisei-38u","title":"advanced_analytics.py: numpy JSON serialization bug, dead param — 0/4 fixed","description":"0/4 findings fixed. (1) BUG: json.dump on line 518 will fail with numpy types from PerformanceAnalyzer — no type conversion (2) Dead parameter: trend_window_days stored but never used (3) math.asin without guard against invalid proportions \u003e1.0 (4) Hardcoded version string '1.0.0'. See docs/code_analysis/keisei_evaluation_analytics_advanced_analytics.analysis.md","status":"closed","priority":3,"issue_type":"bug","owner":"544926+tachyon-beep@users.noreply.github.com","created_at":"2026-02-08T05:56:44.876034616+11:00","created_by":"John Morrissey","updated_at":"2026-02-08T12:12:42.695706671+11:00","closed_at":"2026-02-08T12:12:42.695706671+11:00","close_reason":"Closed"}
{"id":"keisei-3qf","title":"P2-05: Fix duplicate TEST_BATCH_SIZE constants","description":"constants.py lines 75 and 152 — Defined as 16 at line 75, redefined as 32 at line 152. Second silently overwrites first.","status":"closed","priority":2,"issue_type":"bug","owner":"544926+tachyon-beep@users.noreply.github.com","created_at":"2026-02-07T11:01:26.047924431+11:00","created_by":"John Morrissey","updated_at":"2026-02-08T02:13:23.104938864+11:00","closed_at":"2026-02-08T02:13:23.104938864+11:00","close_reason":"Already resolved: constants.py was refactored, only one TEST_BATCH_SIZE=32 at line 66 remains.","dependencies":[{"issue_id":"keisei-3qf","depends_on_id":"keisei-7dh","type":"parent-child","created_at":"2026-02-07T11:03:15.376095715+11:00","created_by":"John Morrissey"}]}
{"id":"keisei-3z9","title":"shogi_core_definitions.py: OBS_UNPROMOTED_ORDER includes KING hazard — 0/4 fixed","description":"0/4 findings fixed. (Obs constants duplication P2-06 is FIXED in constants.py side but shogi_core_definitions.py findings remain.) (1) OBS_UNPROMOTED_ORDER includes KING (8 elements) but hand channels only have 7 slots — using this list for hand iteration would include KING incorrectly (2) MoveTuple union type not runtime-discriminable (3) Remaining duplication observations. See docs/code_analysis/keisei_shogi_shogi_core_definitions.py.analysis.md","status":"open","priority":3,"issue_type":"task","owner":"544926+tachyon-beep@users.noreply.github.com","created_at":"2026-02-08T05:57:32.960662184+11:00","created_by":"John Morrissey","updated_at":"2026-02-08T05:57:32.960662184+11:00"}
{"id":"keisei-4r3","title":"Fix WebUI lifecycle, async callback, and demo fallback regressions","description":"Three runtime regressions from code review: (1) P2: Orphaned Streamlit process if Trainer init fails before try/except block. (2) P2: asyncio.run() in sync path crashes when called from existing event loop. (3) P3: Dashboard silently shows demo data when explicit --state-file path is missing.","status":"closed","priority":2,"issue_type":"bug","owner":"544926+tachyon-beep@users.noreply.github.com","created_at":"2026-02-08T11:36:41.171670845+11:00","created_by":"John Morrissey","updated_at":"2026-02-08T11:40:24.593038141+11:00","closed_at":"2026-02-08T11:40:24.593038141+11:00","close_reason":"All three fixes implemented and verified: (1) Widened try/except scope in trainer.py to cover entire post-WebUI init, (2) Added _run_async_callbacks() helper with event-loop detection in training_loop_manager.py, (3) Added explicit-path guard in streamlit_app.py load_state(). 360 tests passing."}
{"id":"keisei-4wy","title":"tournament.py: evaluate_step_in_memory no-op, no timeout, entity reload — 0/5 fixed","description":"0/5 findings fixed. (1) evaluate_step_in_memory extracts weights then discards them, falls back to regular evaluate_step (2) hasattr check for evaluate_step_in_memory always True (3) Redundant opponent_info is not None checks (4) No per-game timeout enforcement despite config parameter (5) Entity reloading per game with no cross-game caching. See docs/code_analysis/keisei_evaluation_strategies_tournament.analysis.md","status":"open","priority":3,"issue_type":"task","owner":"544926+tachyon-beep@users.noreply.github.com","created_at":"2026-02-08T05:56:52.822929629+11:00","created_by":"John Morrissey","updated_at":"2026-02-08T05:56:52.822929629+11:00"}
{"id":"keisei-505","title":"REGRESSION P2-10: Non-standard Elo batch normalization still present","description":"keisei-8ce was closed with reason 'Fixed batch normalization' but audit confirms issue STILL PRESENT. evaluation/opponents/elo_registry.py:109-114 — update uses K*(score - N*expected) where N=len(results), scaling K-factor inversely with batch size. A 100-game batch gives same magnitude update as 1-game batch. VERIFY: check if the fix was reverted or if the close reason was premature.","status":"closed","priority":2,"issue_type":"bug","owner":"544926+tachyon-beep@users.noreply.github.com","created_at":"2026-02-08T05:55:23.789024071+11:00","created_by":"John Morrissey","updated_at":"2026-02-08T11:55:44.135603194+11:00","closed_at":"2026-02-08T11:55:44.135603194+11:00","close_reason":"Already fixed by commit ed92d0f. The old code normalized by N (K*(score/N - expected)), making batch size irrelevant. Current code uses standard FIDE formula: K*(score - N*expected). Audit re-flagged the fix as the bug."}
{"id":"keisei-5la","title":"[P2] Clean up Streamlit subprocess on Trainer init failure","status":"closed","priority":2,"issue_type":"bug","owner":"544926+tachyon-beep@users.noreply.github.com","created_at":"2026-02-08T06:53:01.236990382+11:00","created_by":"John Morrissey","updated_at":"2026-02-08T11:29:41.261520198+11:00","closed_at":"2026-02-08T11:29:41.261520198+11:00","close_reason":"Closed"}
{"id":"keisei-6af","title":"P2-01: Fix __deepcopy__ dropping move_history","description":"shogi/shogi_game.py — __deepcopy__ omits move_history. Simulations and tree searches lose all game history.","status":"closed","priority":2,"issue_type":"bug","owner":"544926+tachyon-beep@users.noreply.github.com","created_at":"2026-02-07T11:00:51.223964563+11:00","created_by":"John Morrissey","updated_at":"2026-02-08T01:56:55.853623687+11:00","closed_at":"2026-02-08T01:56:55.853623687+11:00","close_reason":"Fix already committed in 8565ba1. Added regression test test_deepcopy_preserves_move_history.","dependencies":[{"issue_id":"keisei-6af","depends_on_id":"keisei-7dh","type":"parent-child","created_at":"2026-02-07T11:02:55.013166631+11:00","created_by":"John Morrissey"}]}
{"id":"keisei-6r7","title":"keisei/__init__.py: incomplete exports and contradictory EvaluationManager import","description":"(1) EvaluationManager import at line 15 contradicts comment about avoiding heavy deps (2) __all__ missing AppConfig and load_config despite common usage (3) Re-exports create coupling surface. See docs/code_analysis/keisei___init__.py.analysis.md","status":"closed","priority":4,"issue_type":"task","owner":"544926+tachyon-beep@users.noreply.github.com","created_at":"2026-02-08T05:55:36.774512624+11:00","created_by":"John Morrissey","updated_at":"2026-02-08T12:04:57.239575049+11:00","closed_at":"2026-02-08T12:04:57.239575049+11:00","close_reason":"Removed misleading comment about avoiding heavy deps — EvaluationManager import is intentional and in __all__."}
{"id":"keisei-6v5","title":"P2-09: Make wandb import conditional","description":"training/model_manager.py, training/utils.py — Unconditional import wandb makes entire modules fail to import if wandb not installed, violating optional-integration pattern.","status":"closed","priority":2,"issue_type":"task","owner":"544926+tachyon-beep@users.noreply.github.com","created_at":"2026-02-07T11:02:01.656028992+11:00","created_by":"John Morrissey","updated_at":"2026-02-08T02:24:04.993256159+11:00","closed_at":"2026-02-08T02:24:04.993256159+11:00","close_reason":"Moved top-level import wandb to lazy imports inside create_model_artifact, _log_artifact_with_retry, and apply_wandb_sweep_config.","dependencies":[{"issue_id":"keisei-6v5","depends_on_id":"keisei-7dh","type":"parent-child","created_at":"2026-02-07T11:03:35.738554971+11:00","created_by":"John Morrissey"}]}
{"id":"keisei-744","title":"WebUI frontend hardcodes WebSocket port 8765, ignoring config","description":"app.js:79 hardcodes 'const port = 8765' for the WebSocket connection, but the backend port is configurable via config.webui.port. Any non-default port setting makes the dashboard permanently disconnected. Fix: inject the configured port into the frontend (e.g., via a config endpoint, template variable, or by using the same port as the HTTP server with a path-based WS upgrade).","status":"closed","priority":2,"issue_type":"bug","owner":"544926+tachyon-beep@users.noreply.github.com","created_at":"2026-02-08T04:25:26.413882089+11:00","created_by":"John Morrissey","updated_at":"2026-02-08T11:55:45.636617198+11:00","closed_at":"2026-02-08T11:55:45.636617198+11:00","close_reason":"Obsolete. WebUI was refactored to Streamlit with atomic JSON state files. No WebSocket code (port 8765 or otherwise) exists anywhere in the codebase. grep confirms zero matches."}
{"id":"keisei-78v","title":"base_actor_critic.py: 6 remaining issues after critical NaN fix","description":"3/9 fixed (NaN handling, unused sys import, batch NaN fallback). Remaining: (1) Legal mask broadcasting only handles batch_size=1 (2) torch.tensor scalar creation inside torch.where on every call (3) Softmax from probs not log-probs (4) Value squeezing is model-dependent and fragile (5) Multiple inheritance with Protocol unusual (6) forward() called explicitly instead of __call__. See docs/code_analysis/keisei_core_base_actor_critic.py.analysis.md","notes":"Finding 2 (torch.tensor scalar creation): FIXED - use torch.finfo().min instead. Remaining: findings 1, 3, 4, 5, 6 deferred.","status":"closed","priority":3,"issue_type":"task","owner":"544926+tachyon-beep@users.noreply.github.com","created_at":"2026-02-08T05:55:49.143885327+11:00","created_by":"John Morrissey","updated_at":"2026-02-08T13:31:58.941270219+11:00","closed_at":"2026-02-08T13:31:58.941270219+11:00","close_reason":"Fixed 4 of 5 remaining findings: (1) Legal mask broadcasting now works for any batch size, not just batch_size=1; (3) Replaced F.softmax+Categorical(probs=) with Categorical(logits=) for numerical stability; (5) Removed Protocol from MRO — structural subtyping works without it; (6) Changed self.forward(obs) to self(obs) so PyTorch hooks fire. Finding 4 (value squeezing) kept as defensive code since both models already squeeze in forward()."}
{"id":"keisei-7dh","title":"Sprint 4: Robustness \u0026 Safety","description":"Game engine safety, config handling, resource management. Includes P1-06 through P1-14 and P2-01 through P2-10.","status":"closed","priority":2,"issue_type":"epic","owner":"544926+tachyon-beep@users.noreply.github.com","created_at":"2026-02-07T10:59:49.026825899+11:00","created_by":"John Morrissey","updated_at":"2026-02-08T02:24:13.315095872+11:00","closed_at":"2026-02-08T02:24:13.315095872+11:00","close_reason":"All 16 Sprint 4 issues resolved: game engine safety, config handling, resource management, action masking, optional imports.","dependencies":[{"issue_id":"keisei-7dh","depends_on_id":"keisei-qwm","type":"blocks","created_at":"2026-02-07T11:04:18.371781094+11:00","created_by":"John Morrissey"}]}
{"id":"keisei-7fw","title":"SO_REUSEADDR set after socket bind in WebUI HTTP server","description":"web_server.py:112 creates HTTPServer((host, port), handler) which binds the socket in __init__ (via TCPServer.server_bind()). Line 116 then sets SO_REUSEADDR after the bind has already happened, making it ineffective for preventing 'Address already in use' errors on restart. Fix: either subclass HTTPServer and set allow_reuse_address = True (checked before bind), or set the socket option before calling the constructor.","status":"closed","priority":2,"issue_type":"bug","owner":"544926+tachyon-beep@users.noreply.github.com","created_at":"2026-02-08T04:25:29.248461137+11:00","created_by":"John Morrissey","updated_at":"2026-02-08T05:54:46.829633793+11:00","closed_at":"2026-02-08T05:54:46.829633793+11:00","close_reason":"Verified fixed: SO_REUSEADDR now set before bind in commit 7bed286"}
{"id":"keisei-7rq","title":"P1-07: Remove redundant attack-check computation in legal move gen","description":"shogi/shogi_rules_logic.py:527-543 — generate_all_legal_moves computes a full attack check that is immediately discarded. Subsequent generate_raw_moves + is_legal_move filter already handles check detection. Approximately 2x slower than necessary.","status":"closed","priority":2,"issue_type":"task","owner":"544926+tachyon-beep@users.noreply.github.com","created_at":"2026-02-07T11:00:05.578984765+11:00","created_by":"John Morrissey","updated_at":"2026-02-08T02:05:25.742010387+11:00","closed_at":"2026-02-08T02:05:25.742010387+11:00","close_reason":"Removed redundant find_king + check_if_square_is_attacked calls in both board-move and drop-move loops. Results were only consumed by commented-out trace prints. is_king_in_check_after_simulated_move already performs the same check.","dependencies":[{"issue_id":"keisei-7rq","depends_on_id":"keisei-7dh","type":"parent-child","created_at":"2026-02-07T11:02:29.573305534+11:00","created_by":"John Morrissey"}]}
{"id":"keisei-8ag","title":"Fix WebUI non-deterministic shutdown (join thread, close loop)","status":"closed","priority":1,"issue_type":"bug","owner":"544926+tachyon-beep@users.noreply.github.com","created_at":"2026-02-07T20:02:43.466758114+11:00","created_by":"John Morrissey","updated_at":"2026-02-07T20:09:33.504040405+11:00","closed_at":"2026-02-07T20:09:33.504040405+11:00","close_reason":"Closed"}
{"id":"keisei-8c7","title":"parallel_executor.py: dead config, hardcoded timeouts, duplication — 5/6 still present","description":"1/6 partially fixed (async gather improved). Remaining: (1) asyncio.run() fallback creates isolated event loops in threads (2) Dead config: max_memory_usage_mb accepted but never enforced (3) Dead config: timeout_per_batch_seconds accepted but hardcoded 300s used (4) Hardcoded 300s timeout overrides config (5) Duplicated event loop detection logic. See docs/code_analysis/keisei_evaluation_core_parallel_executor.analysis.md","status":"open","priority":3,"issue_type":"task","owner":"544926+tachyon-beep@users.noreply.github.com","created_at":"2026-02-08T05:56:37.37793476+11:00","created_by":"John Morrissey","updated_at":"2026-02-08T05:56:37.37793476+11:00"}
{"id":"keisei-8ce","title":"P2-10: Fix non-standard Elo batch normalization","description":"evaluation/opponents/elo_registry.py — Divides scores by len(results) before K-factor. 100-game batch gives same update magnitude as 1-game batch.","status":"closed","priority":2,"issue_type":"bug","owner":"544926+tachyon-beep@users.noreply.github.com","created_at":"2026-02-07T11:02:10.727548749+11:00","created_by":"John Morrissey","updated_at":"2026-02-07T23:17:12.701661131+11:00","closed_at":"2026-02-07T23:17:12.701661131+11:00","close_reason":"Fixed batch normalization: use K*(S_total - N*E) instead of K*(S_total/N - E). Added 4 regression tests.","dependencies":[{"issue_id":"keisei-8ce","depends_on_id":"keisei-7dh","type":"parent-child","created_at":"2026-02-07T11:03:40.825023827+11:00","created_by":"John Morrissey"}]}
{"id":"keisei-9bq","title":"P2-08: Fix se_ratio falsy-value override bug","description":"training/model_manager.py:83 — getattr(...) or config_default pattern means se_ratio=0 falls through to config default instead of being treated as valid value.","status":"closed","priority":2,"issue_type":"bug","owner":"544926+tachyon-beep@users.noreply.github.com","created_at":"2026-02-07T11:01:52.687764261+11:00","created_by":"John Morrissey","updated_at":"2026-02-08T01:46:51.873022349+11:00","closed_at":"2026-02-08T01:46:51.873022349+11:00","close_reason":"Replaced getattr() or default with explicit is not None checks for all 5 config fields in ModelManager.__init__. se_ratio=0 now correctly disables SE blocks.","dependencies":[{"issue_id":"keisei-9bq","depends_on_id":"keisei-7dh","type":"parent-child","created_at":"2026-02-07T11:03:30.648645552+11:00","created_by":"John Morrissey"}]}
{"id":"keisei-9c9","title":"core/__init__.py: ActorCriticProtocol not exported in __all__","description":"ActorCriticProtocol must be imported directly from keisei.core.actor_critic_protocol instead of from keisei.core. Minor API ergonomics issue.","status":"closed","priority":4,"issue_type":"task","owner":"544926+tachyon-beep@users.noreply.github.com","created_at":"2026-02-08T05:55:52.416988204+11:00","created_by":"John Morrissey","updated_at":"2026-02-08T12:04:57.091786919+11:00","closed_at":"2026-02-08T12:04:57.091786919+11:00","close_reason":"Added ActorCriticProtocol import and __all__ export in core/__init__.py."}
{"id":"keisei-a23","title":"opponents.py: move classification if/if/else bug, drop moves unhandled — 0/3 fixed","description":"0/3 findings fixed. (1) if/if/else structure at lines 72-77 means capturing moves appear in both capture list AND other_moves (2) Drop moves not specially classified — fall through to other_moves (3) Direct board[r][c] access couples tightly to ShogiGame internals. See docs/code_analysis/keisei_utils_opponents.analysis.md","status":"closed","priority":3,"issue_type":"bug","owner":"544926+tachyon-beep@users.noreply.github.com","created_at":"2026-02-08T05:57:23.985355218+11:00","created_by":"John Morrissey","updated_at":"2026-02-08T12:07:12.867207195+11:00","closed_at":"2026-02-08T12:07:12.867207195+11:00","close_reason":"Fixed if/if/else -\u003e if/elif/else in move classification. Captures no longer duplicated into other_moves."}
{"id":"keisei-b1d","title":"P2-03: Add board_history pruning mechanism","description":"shogi/shogi_game.py — Every move appends a 9x9 board copy with no pruning. Unbounded growth.","status":"closed","priority":3,"issue_type":"task","owner":"544926+tachyon-beep@users.noreply.github.com","created_at":"2026-02-07T11:01:08.087800306+11:00","created_by":"John Morrissey","updated_at":"2026-02-08T01:06:27.561718036+11:00","closed_at":"2026-02-08T01:06:27.561718036+11:00","close_reason":"Removed redundant board_history (dead data duplicating move_history state_hash). Fixed 4 test files referencing it.","dependencies":[{"issue_id":"keisei-b1d","depends_on_id":"keisei-7dh","type":"parent-child","created_at":"2026-02-07T11:03:05.196986147+11:00","created_by":"John Morrissey"}]}
{"id":"keisei-b6w","title":"experience_buffer.py: silent data loss when buffer full, get_batch returns views","description":"Hard-coded dims (P2-15) are FIXED (parameterized). But remaining issues: (1) CRITICAL: add() silently drops experiences when buffer full — only logs warning, caller gets no indication data was lost. End-of-episode reward signal can be silently lost. add_batch() and merge_from_parallel_buffers() also silent. (2) get_batch() returns tensor views not copies — safe now but fragile if collection/training ever overlap. (3) GAE assumes single-environment sequential collection. See docs/code_analysis/keisei_core_experience_buffer.py.analysis.md","status":"closed","priority":2,"issue_type":"bug","owner":"544926+tachyon-beep@users.noreply.github.com","created_at":"2026-02-08T05:55:41.532309266+11:00","created_by":"John Morrissey","updated_at":"2026-02-08T12:00:02.435509071+11:00","closed_at":"2026-02-08T12:00:02.435509071+11:00","close_reason":"Fixed: add() now returns bool (True=added, False=full). add_batch(), add_from_worker_batch(), merge_from_parallel_buffers() now return int count and log dropped experience counts. All 305 unit tests pass."}
{"id":"keisei-bag","title":"Fix WebUI broadcaster infinite error loop","status":"closed","priority":1,"issue_type":"bug","owner":"544926+tachyon-beep@users.noreply.github.com","created_at":"2026-02-07T20:02:43.497856921+11:00","created_by":"John Morrissey","updated_at":"2026-02-07T20:09:33.509587439+11:00","closed_at":"2026-02-07T20:09:33.509587439+11:00","close_reason":"Closed"}
{"id":"keisei-beq","title":"RC1 Repository Cleanup","description":"Comprehensive repo cleanup bringing repository to release candidate quality. Covers 12 phases: delete debris, consolidate configs, fix pyproject.toml, rewrite README, clean docs/, fix examples/, update .github/, fix scripts, update .gitignore, clean train.py, update CLAUDE.md, fix pre-commit config.","status":"closed","priority":1,"issue_type":"feature","owner":"544926+tachyon-beep@users.noreply.github.com","created_at":"2026-02-08T12:27:36.259255374+11:00","created_by":"John Morrissey","updated_at":"2026-02-08T12:39:26.605850302+11:00","closed_at":"2026-02-08T12:39:26.605850302+11:00","close_reason":"All 12 phases complete: ~120 files deleted, configs consolidated, README rewritten, .github updated, scripts fixed, .gitignore cleaned, train.py cleaned, CLAUDE.md updated, pre-commit fixed"}
{"id":"keisei-bj2","title":"env_manager.py: destructive validate, partial init, no cleanup — 0/8 fixed","description":"0/8 findings fixed. (1) validate_environment() has destructive side effect of resetting game (2) Unused sys import (3) No resource cleanup/close method (4) Partial initialization not rolled back on failure (5) Duplicate reset logic (6) Stale development comments on imports (7) Hardcoded 9x9 board dimensions (8) Verbose logging on every episode reset. See docs/code_analysis/keisei_training_env_manager.analysis.md","notes":"Findings 2 (unused sys import), 6 (stale comments), 7 (hardcoded 9x9): FIXED. Remaining: findings 1, 3, 4, 5, 8 deferred.","status":"closed","priority":3,"issue_type":"task","owner":"544926+tachyon-beep@users.noreply.github.com","created_at":"2026-02-08T05:56:05.381169973+11:00","created_by":"John Morrissey","updated_at":"2026-02-08T13:32:02.547184794+11:00","closed_at":"2026-02-08T13:32:02.547184794+11:00","close_reason":"Fixed 4 of 5 remaining findings: (1) validate_environment() is now non-destructive — no longer resets game state; (4) setup_environment() uses local variables and commits atomically, preventing partial initialization; (5) initialize_game_state() consolidated to use reset_game(), removing duplicate reset logic; (8) Removed verbose per-episode logging from initialize_game_state(). Finding 3 (cleanup method) skipped — ShogiGame holds no external resources."}
{"id":"keisei-c6k","title":"Sprint 1: Security \u0026 Crashes","description":"Fix directory traversal vulnerability, save_checkpoint crash, torch.load security, and escaped newlines. Straightforward fixes with immediate impact.","status":"closed","priority":0,"issue_type":"epic","owner":"544926+tachyon-beep@users.noreply.github.com","created_at":"2026-02-07T10:59:56.946169357+11:00","created_by":"John Morrissey","updated_at":"2026-02-07T11:26:16.228738915+11:00","closed_at":"2026-02-07T11:26:16.228738915+11:00","close_reason":"All 4 P0 bugs fixed: directory traversal, torch.load security, save_checkpoint args, escaped newlines"}
{"id":"keisei-c6k.1","title":"P0-01: Fix directory traversal in WebUI HTTP server","description":"web_server.py:22-29 — translate_path() bypasses SimpleHTTPRequestHandler path sanitization by directly joining user-supplied URL paths with static directory via os.path.join, without normalizing or rejecting .. path components. Combined with binding to 0.0.0.0, attackers can read arbitrary files. Fix: Use os.path.normpath + prefix check, or delegate to parent class translate_path().","status":"closed","priority":0,"issue_type":"bug","owner":"544926+tachyon-beep@users.noreply.github.com","created_at":"2026-02-07T11:00:09.055305463+11:00","created_by":"John Morrissey","updated_at":"2026-02-07T11:26:08.229369355+11:00","closed_at":"2026-02-07T11:26:08.229369355+11:00","close_reason":"Closed","dependencies":[{"issue_id":"keisei-c6k.1","depends_on_id":"keisei-c6k","type":"parent-child","created_at":"2026-02-07T11:00:09.056200839+11:00","created_by":"John Morrissey"}]}
{"id":"keisei-c6k.2","title":"P0-06: Add weights_only=True to all torch.load calls","description":"torch.load without weights_only=True in 4 locations allows arbitrary code execution from untrusted checkpoints: ppo_agent.py:502, training/utils.py:32, evaluation/core_manager.py:94+181, evaluation/core/model_manager.py:111. Fix: Add weights_only=True; use torch.serialization.add_safe_globals() for non-tensor metadata if needed.","status":"closed","priority":0,"issue_type":"bug","owner":"544926+tachyon-beep@users.noreply.github.com","created_at":"2026-02-07T11:00:19.968984777+11:00","created_by":"John Morrissey","updated_at":"2026-02-07T11:26:08.236990274+11:00","closed_at":"2026-02-07T11:26:08.236990274+11:00","close_reason":"Closed","dependencies":[{"issue_id":"keisei-c6k.2","depends_on_id":"keisei-c6k","type":"parent-child","created_at":"2026-02-07T11:00:19.969918215+11:00","created_by":"John Morrissey"}]}
{"id":"keisei-c6k.3","title":"P0-04: Fix save_checkpoint call with wrong arguments","description":"callbacks.py:147-152 — EvaluationCallback.on_step_end() calls save_checkpoint(agent, timestep, run_artifact_dir, name) with 4 args in wrong order. ModelManager.save_checkpoint requires (agent, model_dir, timestep, episode_count, stats, run_name, is_wandb_active). Will raise TypeError at runtime. Also return value is Tuple[bool, Optional[str]] but treated as path string. Fix: Pass all 7 required args in correct order; unpack return tuple.","status":"closed","priority":0,"issue_type":"bug","owner":"544926+tachyon-beep@users.noreply.github.com","created_at":"2026-02-07T11:00:31.085610021+11:00","created_by":"John Morrissey","updated_at":"2026-02-07T11:26:08.244517927+11:00","closed_at":"2026-02-07T11:26:08.244517927+11:00","close_reason":"Closed","dependencies":[{"issue_id":"keisei-c6k.3","depends_on_id":"keisei-c6k","type":"parent-child","created_at":"2026-02-07T11:00:31.087006425+11:00","created_by":"John Morrissey"}]}
{"id":"keisei-c6k.4","title":"P0-07: Fix escaped newlines in log file writes","description":"utils.py:514,561 — TrainingLogger.log() and EvaluationLogger.log() write literal backslash-n instead of actual newline to log files, making all log files single unbroken lines. Fix: Change escaped backslash-n to actual newline in both write calls.","status":"closed","priority":0,"issue_type":"bug","owner":"544926+tachyon-beep@users.noreply.github.com","created_at":"2026-02-07T11:00:40.444364564+11:00","created_by":"John Morrissey","updated_at":"2026-02-07T11:26:08.251780153+11:00","closed_at":"2026-02-07T11:26:08.251780153+11:00","close_reason":"Closed","dependencies":[{"issue_id":"keisei-c6k.4","depends_on_id":"keisei-c6k","type":"parent-child","created_at":"2026-02-07T11:00:40.445177537+11:00","created_by":"John Morrissey"}]}
{"id":"keisei-ccp","title":"Write unit tests for 4 zero-coverage files (model_sync, agent_loading, communication, self_play_worker)","status":"closed","priority":2,"issue_type":"task","owner":"544926+tachyon-beep@users.noreply.github.com","created_at":"2026-02-08T19:11:37.125187509+11:00","created_by":"John Morrissey","updated_at":"2026-02-08T19:37:49.475074719+11:00","closed_at":"2026-02-08T19:37:49.475074719+11:00","close_reason":"All 4 test files written and passing: test_model_sync (18), test_agent_loading (11), test_communication (23), test_self_play_worker (28) = 80 new tests"}
{"id":"keisei-cem","title":"single_opponent.py: incorrect median calc, thread safety, duplication — 0/5 fixed","description":"0/5 findings fixed. (1) BUG: Median calc at lines 861,868 uses sorted()[len//2] — wrong for even-length lists (should average two middle elements) (2) Non-thread-safe instance state: agent_weights/opponent_weights stored on self during evaluation (3) Opponent type mapping inconsistency: 'random' fallback vs 'unknown' in different paths (4) Massive code duplication between file-based and in-memory paths (5) Near-dead imbalance warning never triggers. See docs/code_analysis/keisei_evaluation_strategies_single_opponent.analysis.md","status":"closed","priority":3,"issue_type":"bug","owner":"544926+tachyon-beep@users.noreply.github.com","created_at":"2026-02-08T05:56:48.93400338+11:00","created_by":"John Morrissey","updated_at":"2026-02-08T13:00:35.241222066+11:00","closed_at":"2026-02-08T13:00:35.241222066+11:00","close_reason":"Already fixed: single_opponent.py lines 862,869 use statistics.median()"}
{"id":"keisei-cg8","title":"WebUI tactical strength reads nonexistent history.win_rates field","description":"webui_manager.py:638 reads history.win_rates but MetricsHistory (metrics_manager.py:45) stores data in win_rates_history. The AttributeError is silently caught (line 643), returning 0.5 always. Tactical skill visualization never reflects real training data. display.py:277 correctly uses history.win_rates_history. Fix: change history.win_rates to history.win_rates_history on line 638.","status":"closed","priority":3,"issue_type":"bug","owner":"544926+tachyon-beep@users.noreply.github.com","created_at":"2026-02-08T04:25:31.87060693+11:00","created_by":"John Morrissey","updated_at":"2026-02-08T12:04:57.122329135+11:00","closed_at":"2026-02-08T12:04:57.122329135+11:00","close_reason":"Obsolete: old webui_manager.py replaced by streamlit_manager.py. state_snapshot.py correctly uses win_rates_history."}
{"id":"keisei-ck3","title":"[P1] Execute async callbacks in sync training loop path","status":"closed","priority":1,"issue_type":"bug","owner":"544926+tachyon-beep@users.noreply.github.com","created_at":"2026-02-08T06:52:59.194921742+11:00","created_by":"John Morrissey","updated_at":"2026-02-08T11:29:41.236527911+11:00","closed_at":"2026-02-08T11:29:41.236527911+11:00","close_reason":"Closed"}
{"id":"keisei-d1c","title":"metrics_manager.py: side-effect formatting, suboptimal trim, 0/6 fixed","description":"0/6 findings fixed. P2-13 (incomplete restore) and P2-14 (thread-safe flag) tracked in y28.1. Additional: (1) format_ppo_metrics has side effect of recording to history (2) Inconsistent rate units: get_win_rates returns 0-100, get_win_loss_draw_rates returns 0-1 (3) Suboptimal trimming with list.pop(0) instead of deque (4) Unnecessary sort of already-ordered data. See docs/code_analysis/keisei_training_metrics_manager.analysis.md","notes":"Finding 3 (suboptimal list.pop(0) trim): FIXED - converted to deque(maxlen=N). _trim method removed. Remaining: findings 1, 2, 4 deferred.","status":"closed","priority":3,"issue_type":"task","owner":"544926+tachyon-beep@users.noreply.github.com","created_at":"2026-02-08T05:56:25.409342115+11:00","created_by":"John Morrissey","updated_at":"2026-02-08T13:12:54.570943554+11:00","closed_at":"2026-02-08T13:12:54.570943554+11:00","close_reason":"Fixed 3 remaining findings: (1) Removed side-effect from format_ppo_metrics, moved add_ppo_data to trainer.py caller; (2) Normalized get_win_loss_draw_rates to return 0-100 percentages matching get_win_rates; (3) Replaced O(n log n) sorted() with direct slice on already-ordered deque."}
{"id":"keisei-d6t","title":"[P2] Honor webui.update_rate_hz for snapshot write throttling","status":"closed","priority":2,"issue_type":"bug","owner":"544926+tachyon-beep@users.noreply.github.com","created_at":"2026-02-08T06:53:00.190532297+11:00","created_by":"John Morrissey","updated_at":"2026-02-08T11:29:41.254635707+11:00","closed_at":"2026-02-08T11:29:41.254635707+11:00","close_reason":"Closed"}
{"id":"keisei-d8n","title":"Sprint 2: Training Correctness","description":"Fix evaluate_actions return order, batch-wide NaN fallback, silent checkpoint failure, hand piece normalization, and training state safety. Directly impacts training fidelity.","status":"closed","priority":0,"issue_type":"epic","owner":"544926+tachyon-beep@users.noreply.github.com","created_at":"2026-02-07T10:59:55.554932038+11:00","created_by":"John Morrissey","updated_at":"2026-02-07T11:49:51.443384475+11:00","closed_at":"2026-02-07T11:49:51.443384475+11:00","close_reason":"Closed","dependencies":[{"issue_id":"keisei-d8n","depends_on_id":"keisei-c6k","type":"blocks","created_at":"2026-02-07T11:04:08.226541116+11:00","created_by":"John Morrissey"}]}
{"id":"keisei-d8n.1","title":"P0-02: Align evaluate_actions return order across protocol and implementations","description":"Protocol docstring says (log_probs, values, entropy). BaseActorCriticModel returns (log_probs, entropy, value). PPO Agent unpacks as (log_probs, entropy, new_values) — matches implementation. DynamicActorCritic in evaluation/core/model_manager.py:428 returns (log_probs, value, entropy) — matches NEITHER. Training path is correct but evaluation path is broken. Fix: Align protocol docstring, all implementations, and all callers to single order (log_probs, entropy, value) matching the training path.","status":"closed","priority":0,"issue_type":"bug","owner":"544926+tachyon-beep@users.noreply.github.com","created_at":"2026-02-07T11:00:08.790688843+11:00","created_by":"John Morrissey","updated_at":"2026-02-07T11:31:17.194722909+11:00","closed_at":"2026-02-07T11:31:17.194722909+11:00","close_reason":"Closed","dependencies":[{"issue_id":"keisei-d8n.1","depends_on_id":"keisei-d8n","type":"parent-child","created_at":"2026-02-07T11:00:08.791796226+11:00","created_by":"John Morrissey"}]}
{"id":"keisei-d8n.2","title":"P0-03: Fix batch-wide NaN fallback in get_action_and_value","description":"base_actor_critic.py:93-101 — When any single sample in a batch has all legal actions masked, torch.isnan(probs).any() triggers batch-wide uniform fallback replacing policy distribution for ALL samples including valid ones. Note: evaluate_actions already handles per-row NaN correctly at line 168-174. Fix: Apply NaN fallback per-sample in get_action_and_value, matching evaluate_actions pattern.","status":"closed","priority":0,"issue_type":"bug","owner":"544926+tachyon-beep@users.noreply.github.com","created_at":"2026-02-07T11:00:19.507584835+11:00","created_by":"John Morrissey","updated_at":"2026-02-07T11:31:17.200323745+11:00","closed_at":"2026-02-07T11:31:17.200323745+11:00","close_reason":"Closed","dependencies":[{"issue_id":"keisei-d8n.2","depends_on_id":"keisei-d8n","type":"parent-child","created_at":"2026-02-07T11:00:19.508870572+11:00","created_by":"John Morrissey"}]}
{"id":"keisei-d8n.3","title":"P0-08: Raise on checkpoint load failure instead of silent continue","description":"model_manager.py:346,362 — PPOAgent.load_model() returns dict with error key on failure. ModelManager stores this as self.checkpoint_data and returns True (success). Training continues from random initialization believing it has resumed. Fix: Validate returned dict structure; raise exception on checkpoint load failure.","status":"closed","priority":0,"issue_type":"bug","owner":"544926+tachyon-beep@users.noreply.github.com","created_at":"2026-02-07T11:00:29.95218997+11:00","created_by":"John Morrissey","updated_at":"2026-02-07T11:31:17.205905525+11:00","closed_at":"2026-02-07T11:31:17.205905525+11:00","close_reason":"Closed","dependencies":[{"issue_id":"keisei-d8n.3","depends_on_id":"keisei-d8n","type":"parent-child","created_at":"2026-02-07T11:00:29.953409643+11:00","created_by":"John Morrissey"}]}
{"id":"keisei-d8n.4","title":"P0-09: Fix hand piece normalization with per-type maximums","description":"shogi_game_io.py:514,527 — Hand piece channel normalization divides by 18.0 for ALL piece types. Correct maximums: Pawns=18, Lances/Knights/Silvers/Golds=4, Bishops/Rooks=2. Using /18.0 for Bishops means 2 in hand produces 0.11 instead of 1.0, compressing dynamic range. Fix: Use per-piece-type maximum counts for normalization.","status":"closed","priority":1,"issue_type":"bug","owner":"544926+tachyon-beep@users.noreply.github.com","created_at":"2026-02-07T11:00:40.933563592+11:00","created_by":"John Morrissey","updated_at":"2026-02-07T11:49:44.709136447+11:00","closed_at":"2026-02-07T11:49:44.709136447+11:00","close_reason":"Closed","dependencies":[{"issue_id":"keisei-d8n.4","depends_on_id":"keisei-d8n","type":"parent-child","created_at":"2026-02-07T11:00:40.934419906+11:00","created_by":"John Morrissey"}]}
{"id":"keisei-d8n.5","title":"P1-09: Add try/finally for processing state in training loop","description":"training_loop_manager.py:138-149 — If perform_ppo_update raises, set_processing(False) is never called, permanently leaving metrics manager in stale processing state. Fix: Wrap PPO update in try/finally to ensure set_processing(False) is always called.","status":"closed","priority":1,"issue_type":"bug","owner":"544926+tachyon-beep@users.noreply.github.com","created_at":"2026-02-07T11:00:50.703949621+11:00","created_by":"John Morrissey","updated_at":"2026-02-07T11:49:44.714897333+11:00","closed_at":"2026-02-07T11:49:44.714897333+11:00","close_reason":"Closed","dependencies":[{"issue_id":"keisei-d8n.5","depends_on_id":"keisei-d8n","type":"parent-child","created_at":"2026-02-07T11:00:50.704781929+11:00","created_by":"John Morrissey"}]}
{"id":"keisei-d8n.6","title":"P1-10: Add try/finally for eval/train mode in callbacks","description":"callbacks.py — EvaluationCallback sets model to eval mode before evaluation but has no try/finally to restore train mode if evaluation raises. This silently degrades subsequent training. Fix: Wrap evaluation in try/finally to ensure model.train() is always called.","status":"closed","priority":1,"issue_type":"bug","owner":"544926+tachyon-beep@users.noreply.github.com","created_at":"2026-02-07T11:01:00.170656034+11:00","created_by":"John Morrissey","updated_at":"2026-02-07T11:49:44.721491338+11:00","closed_at":"2026-02-07T11:49:44.721491338+11:00","close_reason":"Closed","dependencies":[{"issue_id":"keisei-d8n.6","depends_on_id":"keisei-d8n","type":"parent-child","created_at":"2026-02-07T11:01:00.171494323+11:00","created_by":"John Morrissey"}]}
{"id":"keisei-dsq","title":"Rewrite test_env_manager.py: replace mock-only tests with real integration tests","description":"test_env_manager.py has 19 tests that ALL patch ShogiGame and PolicyOutputMapper with mocks. None test real behavior — they test that EnvManager calls mock methods in the right order. Even get_environment_info asserts 'game_type': 'Mock' as expected output (line 601).\n\nThe seeding tests (TestEnvManagerSeeding, 4 tests) duplicate test_seeding.py::TestEnvManagerSeeding (3 tests) which uses real objects and is strictly better.\n\nPlan:\n1. Delete TestEnvManagerSeeding from test_env_manager.py (duplicated by real tests in test_seeding.py)\n2. Rewrite remaining tests to use real ShogiGame/PolicyOutputMapper (follow test_seeding.py and test_trainer_config.py patterns)\n3. For error-path tests (game init failure, mapper mismatch), mocking is acceptable — keep those but label clearly\n4. Target: \u003c5 mock tests for error paths, rest should exercise real code","status":"open","priority":3,"issue_type":"task","owner":"544926+tachyon-beep@users.noreply.github.com","created_at":"2026-02-08T05:15:18.390996982+11:00","created_by":"John Morrissey","updated_at":"2026-02-08T05:15:18.390996982+11:00"}
{"id":"keisei-e3w","title":"Fix WebUI false-positive startup reporting","status":"closed","priority":2,"issue_type":"bug","owner":"544926+tachyon-beep@users.noreply.github.com","created_at":"2026-02-07T20:02:43.525137019+11:00","created_by":"John Morrissey","updated_at":"2026-02-07T20:09:33.515046539+11:00","closed_at":"2026-02-07T20:09:33.515046539+11:00","close_reason":"Closed"}
{"id":"keisei-ec9","title":"utils.py: missing webui in top_keys, EvalLogger uses error for info — 6/8 remaining","description":"2/8 fixed (P0-07 escaped newlines, P1-12 deep merge). Remaining: (1) 'webui' missing from top_keys set — WebUI config overrides not recognized as structured (2) EvaluationLogger.log() calls log_error_to_stderr for routine messages — misleading log level (3) Additional issues from analysis still present. See docs/code_analysis/keisei_utils_utils.analysis.md","status":"closed","priority":3,"issue_type":"bug","owner":"544926+tachyon-beep@users.noreply.github.com","created_at":"2026-02-08T05:57:16.762157734+11:00","created_by":"John Morrissey","updated_at":"2026-02-08T12:04:57.151256897+11:00","closed_at":"2026-02-08T12:04:57.151256897+11:00","close_reason":"Added webui to top_keys set. Changed EvaluationLogger.log() from log_error_to_stderr to log_info_to_stderr."}
{"id":"keisei-ef1","title":"callback_manager.py: division by zero, triple duplication, dead imports — 0/7 fixed","description":"0/7 findings fixed. (1) Division by zero if steps_per_epoch=0 (lines 42,61,92,256 all do %%steps_per_epoch) (2) Triple-duplicated eval interval alignment logic across setup_default_callbacks, setup_async_callbacks, use_async_evaluation (3) setup_default_callbacks silently overwrites prior callbacks (4) Unused asyncio import (5) print() calls instead of unified_logger (6) No callback lifecycle/cleanup management (7) Error messages lose stack traces. See docs/code_analysis/keisei_training_callback_manager.analysis.md","status":"closed","priority":3,"issue_type":"bug","owner":"544926+tachyon-beep@users.noreply.github.com","created_at":"2026-02-08T05:56:01.463189735+11:00","created_by":"John Morrissey","updated_at":"2026-02-08T12:12:42.69021588+11:00","closed_at":"2026-02-08T12:12:42.69021588+11:00","close_reason":"Closed"}
{"id":"keisei-emf","title":"Simplify over-mocked TestTrainerIntegration in test_session_manager.py","description":"TestTrainerIntegration in test_session_manager.py (2 tests) uses a setup_trainer_mocks fixture with 13+ patches (ShogiGame, PolicyOutputMapper, model_factory, PPOAgent, FEATURE_SPECS, SessionManager methods, generate_run_name, builtins.open, os.path.join, glob.glob, os.path.exists, ResourceMonitor). This is extremely fragile — any refactor to Trainer.__init__ breaks these tests even if behavior is correct.\n\nCompare with test_trainer_config.py which creates a real Trainer with only 1 mock (ResourceMonitor) and tests the same initialization path more reliably.\n\nOptions:\n- Delete TestTrainerIntegration (test_trainer_config.py covers the same ground better)\n- Or rewrite to use real objects like test_trainer_config.py does\n\nThe rest of test_session_manager.py (init, error handling, properties, logging — 17 tests) is fine and tests real SessionManager logic.","status":"open","priority":4,"issue_type":"task","owner":"544926+tachyon-beep@users.noreply.github.com","created_at":"2026-02-08T05:15:24.215123992+11:00","created_by":"John Morrissey","updated_at":"2026-02-08T05:15:24.215123992+11:00"}
{"id":"keisei-f7u","title":"webui_manager.py: recent_episodes fabricated data, bare except clauses — 3.5/5 remaining","description":"1.5/5 fixed (history.win_rates fixed, strength calcs improved). Remaining: (1) recent_episodes attribute still doesn't exist — fallback generates random data (2) Bare except: clauses silently suppress all exceptions (3) max_connections config still never enforced (tracked in y28.4). See docs/code_analysis/keisei_webui_webui_manager.analysis.md","status":"closed","priority":3,"issue_type":"bug","owner":"544926+tachyon-beep@users.noreply.github.com","created_at":"2026-02-08T05:57:52.116999357+11:00","created_by":"John Morrissey","updated_at":"2026-02-08T12:08:33.941132551+11:00","closed_at":"2026-02-08T12:08:33.941132551+11:00","close_reason":"Obsolete: webui_manager.py was deleted and replaced by streamlit_manager.py (165 lines, no fabricated data, no bare excepts)."}
{"id":"keisei-gfx","title":"P2-02: Add bounds checking to set_piece","description":"shogi/shogi_game.py — set_piece allows out-of-bounds writes with no bounds checking on row/column coordinates.","status":"closed","priority":2,"issue_type":"bug","owner":"544926+tachyon-beep@users.noreply.github.com","created_at":"2026-02-07T11:00:59.342745083+11:00","created_by":"John Morrissey","updated_at":"2026-02-08T01:56:55.878192305+11:00","closed_at":"2026-02-08T01:56:55.878192305+11:00","close_reason":"Fix already committed in 8565ba1. Added regression test test_set_piece_rejects_out_of_bounds with 5 boundary cases.","dependencies":[{"issue_id":"keisei-gfx","depends_on_id":"keisei-7dh","type":"parent-child","created_at":"2026-02-07T11:03:00.099607044+11:00","created_by":"John Morrissey"}]}
{"id":"keisei-h8f","title":"compilation_validator.py: no-op decorator, model left in eval mode — 0/3 fixed","description":"0/3 findings fixed. (1) create_compilation_decorator creates decorator that never calls compile_model — returned model is unmodified (2) __str__ treats 0.0 performance_improvement as falsy (3) Validation leaves model in eval mode without restoring train mode. See docs/code_analysis/keisei_utils_compilation_validator.analysis.md","status":"closed","priority":4,"issue_type":"task","owner":"544926+tachyon-beep@users.noreply.github.com","created_at":"2026-02-08T05:57:20.368764224+11:00","created_by":"John Morrissey","updated_at":"2026-02-08T12:07:12.923660785+11:00","closed_at":"2026-02-08T12:07:12.923660785+11:00","close_reason":"Fixed __str__ treating 0.0 performance_improvement as falsy (now checks 'is not None'). _validate_compiled_model now restores original training mode via try/finally."}
{"id":"keisei-i2l","title":"P1-08: Add exception safety to check_for_uchi_fu_zume","description":"shogi/shogi_rules_logic.py — check_for_uchi_fu_zume makes speculative moves to test but uses no try/finally to ensure state is restored on exception. Game state corruption if exception occurs.","status":"closed","priority":1,"issue_type":"bug","owner":"544926+tachyon-beep@users.noreply.github.com","created_at":"2026-02-07T11:00:14.736521236+11:00","created_by":"John Morrissey","updated_at":"2026-02-07T19:45:35.623048333+11:00","closed_at":"2026-02-07T19:45:35.623048333+11:00","close_reason":"Closed","dependencies":[{"issue_id":"keisei-i2l","depends_on_id":"keisei-7dh","type":"parent-child","created_at":"2026-02-07T11:02:34.657560766+11:00","created_by":"John Morrissey"}]}
{"id":"keisei-l5m","title":"P1-13: Decouple Elo tracking from log availability","description":"training/callbacks.py — Elo registry update gated by log_both is not None. If logging unavailable, Elo tracking silently stops. Should be independent of logging.","status":"closed","priority":2,"issue_type":"bug","owner":"544926+tachyon-beep@users.noreply.github.com","created_at":"2026-02-07T11:00:33.395941118+11:00","created_by":"John Morrissey","updated_at":"2026-02-08T01:30:16.920279888+11:00","closed_at":"2026-02-08T01:30:16.920279888+11:00","close_reason":"Moved Elo registry update out of log_both guard in both EvaluationCallback and AsyncEvaluationCallback. Elo tracking now runs independently of logging availability.","dependencies":[{"issue_id":"keisei-l5m","depends_on_id":"keisei-7dh","type":"parent-child","created_at":"2026-02-07T11:02:44.835688276+11:00","created_by":"John Morrissey"}]}
{"id":"keisei-ldl","title":"P2-07: Handle all-legal-actions-masked case properly","description":"core/base_actor_critic.py — When all legal actions masked, produces uniform distribution over all 13527 actions including illegal ones.","status":"closed","priority":2,"issue_type":"bug","owner":"544926+tachyon-beep@users.noreply.github.com","created_at":"2026-02-07T11:01:43.525738166+11:00","created_by":"John Morrissey","updated_at":"2026-02-08T02:12:40.037903971+11:00","closed_at":"2026-02-08T02:12:40.037903971+11:00","close_reason":"Fixed: all-masked early-return in get_action_and_value, per-row zeroing in evaluate_actions. 3 regression tests added.","dependencies":[{"issue_id":"keisei-ldl","depends_on_id":"keisei-7dh","type":"parent-child","created_at":"2026-02-07T11:03:25.552165242+11:00","created_by":"John Morrissey"}]}
{"id":"keisei-m59","title":"shogi_game.py: sennichite timing fragile, concurrent player mutation — 4/8 remaining","description":"3-4 of 8 fixed (deepcopy, set_piece, board_history removed). Remaining: (1) Sennichite hash recorded BEFORE player switch, checked AFTER — mismatch risk (2) make_move returns early with misleading data when game is over (3) get_king_legal_moves temporarily mutates current_player — not thread-safe (4) _restore_board_and_hands_for_undo silently swallows hand inconsistency. See docs/code_analysis/keisei_shogi_shogi_game.py.analysis.md","status":"closed","priority":3,"issue_type":"task","owner":"544926+tachyon-beep@users.noreply.github.com","created_at":"2026-02-08T05:57:37.203617657+11:00","created_by":"John Morrissey","updated_at":"2026-02-08T18:45:37.352208993+11:00","closed_at":"2026-02-08T18:45:37.352208993+11:00","close_reason":"RC1 must-fix bugs addressed: WebUI host default, sennichite comments, checkpoint cleanup, CLI defaults, is_in_check corruption masking"}
{"id":"keisei-m9v","title":"background_tournament.py: lock race condition, unbounded memory, sync IO — 0/5 fixed","description":"0/5 findings fixed. (1) Lock deletion race: _cleanup_tournament deletes lock while _update_progress may acquire it (2) Unbounded memory: _active_tournaments never cleaned, only locks deleted (3) Tight coupling to private evaluator methods (_play_games_against_opponent, _calculate_tournament_standings) (4) Hardcoded 150ms sleep for test infrastructure (5) Synchronous file I/O in async context blocks event loop. See docs/code_analysis/keisei_evaluation_core_background_tournament.analysis.md","status":"closed","priority":3,"issue_type":"bug","owner":"544926+tachyon-beep@users.noreply.github.com","created_at":"2026-02-08T05:56:30.062287238+11:00","created_by":"John Morrissey","updated_at":"2026-02-08T13:00:35.286330472+11:00","closed_at":"2026-02-08T13:00:35.286330472+11:00","close_reason":"Already fixed: _update_progress wraps lock access in try/except KeyError (lines 381-384)"}
{"id":"keisei-mfg","title":"shogi_game_io.py: sys.path.insert side effect, current player indicator redundant — 4/9 remaining","description":"4-5 of 9 fixed (P0-09 hand normalization, KIF encoding, drop moves, termination map). Remaining: (1) Module-level sys.path.insert pollutes Python path globally (2) Board perspective flip contract with PolicyOutputMapper undocumented (3) get_unpromoted_types() creates new list every call in hot path (4) Current player indicator plane is redundant given board flip. See docs/code_analysis/keisei_shogi_shogi_game_io.py.analysis.md","notes":"Finding 1 (sys.path.insert): FIXED - removed sys.path.insert and unused sys/os imports. Remaining: findings 2, 3, 4.","status":"open","priority":3,"issue_type":"task","owner":"544926+tachyon-beep@users.noreply.github.com","created_at":"2026-02-08T05:57:42.412670858+11:00","created_by":"John Morrissey","updated_at":"2026-02-08T12:23:55.407252464+11:00"}
{"id":"keisei-mm1","title":"trainer.py: dead _handle_checkpoint_resume, misleading checkpoint log","description":"1.5/5 fixed (weight cloning conditional, port overflow removed). Remaining: (1) Dead code: _handle_checkpoint_resume (lines 451-473) duplicates _initialize_components and is never called (2) Misleading checkpoint resume log: line 428 prints boolean instead of path (3) WebUI partial init risk reduced but not eliminated. See docs/code_analysis/keisei_training_trainer.analysis.md","status":"closed","priority":3,"issue_type":"task","owner":"544926+tachyon-beep@users.noreply.github.com","created_at":"2026-02-08T05:56:18.154234674+11:00","created_by":"John Morrissey","updated_at":"2026-02-08T12:04:57.183210215+11:00","closed_at":"2026-02-08T12:04:57.183210215+11:00","close_reason":"Deleted dead _handle_checkpoint_resume (never called). Fixed resumed_from_checkpoint type: False -\u003e Optional[str] = None."}
{"id":"keisei-orq","title":"Async evaluation callbacks silently dropped in sync training loop","description":"train.py:131 defines --enable-async-evaluation CLI arg, train.py:363-364 registers async callbacks via use_async_evaluation(), but train.py:367 calls run_training_loop() which always uses the sync run() path (trainer.py:458). The sync run() at training_loop_manager.py:153 only calls execute_step_callbacks() and never executes async callbacks. The TODO at line 155-161 acknowledges this but incorrectly claims no production caller triggers it. Fix: either bridge async callbacks in the sync path, or raise an error in run() when async callbacks are registered.","status":"closed","priority":1,"issue_type":"bug","owner":"544926+tachyon-beep@users.noreply.github.com","created_at":"2026-02-08T04:25:22.919642265+11:00","created_by":"John Morrissey","updated_at":"2026-02-08T11:51:31.488819751+11:00","closed_at":"2026-02-08T11:51:31.488819751+11:00","close_reason":"Already fixed. training_loop_manager.py:155-163 bridges async callbacks into the sync run() path via _run_async_callbacks() (line 280), which handles both standalone and nested event-loop contexts. Regression tests pass."}
{"id":"keisei-qwm","title":"Sprint 3: Evaluation Pipeline","description":"Fix or remove CustomEvaluator placeholder, unbreak async callbacks, fix ladder/benchmark config access bugs, fix inverted recency bonus, fix EvaluationResult deserialization, fix blocking async. Isolated to evaluation subsystem.","status":"closed","priority":1,"issue_type":"epic","owner":"544926+tachyon-beep@users.noreply.github.com","created_at":"2026-02-07T10:59:52.982559309+11:00","created_by":"John Morrissey","updated_at":"2026-02-07T17:04:46.700227135+11:00","closed_at":"2026-02-07T17:04:46.700227135+11:00","close_reason":"Closed","dependencies":[{"issue_id":"keisei-qwm","depends_on_id":"keisei-d8n","type":"blocks","created_at":"2026-02-07T11:04:13.298505147+11:00","created_by":"John Morrissey"}]}
{"id":"keisei-qwm.1","title":"P0-05: Replace CustomEvaluator random results with NotImplementedError","description":"evaluation/strategies/custom.py:271-286 — evaluate_step() returns random.choice([0,1,None]) as results. All 414 lines of evaluation orchestration produce fabricated metrics with no actual Shogi games. Fix: Raise NotImplementedError or implement actual game execution. Decision needed: delete entirely vs implement.","status":"closed","priority":0,"issue_type":"bug","owner":"544926+tachyon-beep@users.noreply.github.com","created_at":"2026-02-07T11:00:02.324253758+11:00","created_by":"John Morrissey","updated_at":"2026-02-07T17:04:42.703969482+11:00","closed_at":"2026-02-07T17:04:42.703969482+11:00","close_reason":"Closed","dependencies":[{"issue_id":"keisei-qwm.1","depends_on_id":"keisei-qwm","type":"parent-child","created_at":"2026-02-07T11:00:02.325113097+11:00","created_by":"John Morrissey"}]}
{"id":"keisei-qwm.2","title":"P1-01: Remove or fix dead async callback path","description":"train.py and training_loop_manager.py — main() is async via asyncio.run(), so event loop is always active. _run_async_callbacks_sync() detects running loop and skips all async callbacks with warning. Async evaluation path is structurally dead. Decision needed: remove async path entirely or restructure to work.","status":"closed","priority":1,"issue_type":"bug","owner":"544926+tachyon-beep@users.noreply.github.com","created_at":"2026-02-07T11:00:10.774279981+11:00","created_by":"John Morrissey","updated_at":"2026-02-07T17:04:42.709608729+11:00","closed_at":"2026-02-07T17:04:42.709608729+11:00","close_reason":"Closed","dependencies":[{"issue_id":"keisei-qwm.2","depends_on_id":"keisei-qwm","type":"parent-child","created_at":"2026-02-07T11:00:10.775324917+11:00","created_by":"John Morrissey"}]}
{"id":"keisei-qwm.3","title":"P1-02: Fix ladder evaluator config access bugs (3 locations)","description":"evaluation/strategies/ladder.py — (1) Line 512: getattr(self.config, num_games_per_match, 2) always returns 2, value lives in strategy_params. (2) Line 726: getattr(self.config, num_opponents_to_select, 5) always returns 5. (3) Line 715: opp.name != agent_rating compares string to float, always True, making opponent self-exclusion a no-op.","status":"closed","priority":1,"issue_type":"bug","owner":"544926+tachyon-beep@users.noreply.github.com","created_at":"2026-02-07T11:00:19.426956451+11:00","created_by":"John Morrissey","updated_at":"2026-02-07T17:04:42.71543211+11:00","closed_at":"2026-02-07T17:04:42.71543211+11:00","close_reason":"Closed","dependencies":[{"issue_id":"keisei-qwm.3","depends_on_id":"keisei-qwm","type":"parent-child","created_at":"2026-02-07T11:00:19.428349129+11:00","created_by":"John Morrissey"}]}
{"id":"keisei-qwm.4","title":"P1-03: Fix benchmark evaluator config access bug","description":"evaluation/strategies/benchmark.py:158 — getattr(self.config, num_games_per_benchmark_case, 1) always returns 1 because parameter is in strategy_params, not a direct attribute. Multi-game-per-case configurations silently ignored.","status":"closed","priority":1,"issue_type":"bug","owner":"544926+tachyon-beep@users.noreply.github.com","created_at":"2026-02-07T11:00:28.483562827+11:00","created_by":"John Morrissey","updated_at":"2026-02-07T17:04:42.722436393+11:00","closed_at":"2026-02-07T17:04:42.722436393+11:00","close_reason":"Closed","dependencies":[{"issue_id":"keisei-qwm.4","depends_on_id":"keisei-qwm","type":"parent-child","created_at":"2026-02-07T11:00:28.484502707+11:00","created_by":"John Morrissey"}]}
{"id":"keisei-qwm.5","title":"P1-04: Fix inverted recency bonus in opponent selection","description":"evaluation/opponents/enhanced_manager.py:351 — Comment says Bonus for less recently played opponents but math awards higher bonus to MORE recently played opponents, inverting intended curriculum behavior. Fix: Invert the recency calculation.","status":"closed","priority":1,"issue_type":"bug","owner":"544926+tachyon-beep@users.noreply.github.com","created_at":"2026-02-07T11:00:38.240636341+11:00","created_by":"John Morrissey","updated_at":"2026-02-07T17:04:42.729586047+11:00","closed_at":"2026-02-07T17:04:42.729586047+11:00","close_reason":"Closed","dependencies":[{"issue_id":"keisei-qwm.5","depends_on_id":"keisei-qwm","type":"parent-child","created_at":"2026-02-07T11:00:38.24149549+11:00","created_by":"John Morrissey"}]}
{"id":"keisei-qwm.6","title":"P1-05: Fix EvaluationResult.from_dict() undefined function call","description":"evaluation/core/evaluation_result.py:330-333 — from_dict() calls get_config_class() which is never defined or imported. Fallback calls EvaluationConfig.from_dict() which doesn't exist on the Pydantic model. Deserialization is completely broken.","status":"closed","priority":1,"issue_type":"bug","owner":"544926+tachyon-beep@users.noreply.github.com","created_at":"2026-02-07T11:00:47.826471279+11:00","created_by":"John Morrissey","updated_at":"2026-02-07T17:04:42.735574798+11:00","closed_at":"2026-02-07T17:04:42.735574798+11:00","close_reason":"Closed","dependencies":[{"issue_id":"keisei-qwm.6","depends_on_id":"keisei-qwm","type":"parent-child","created_at":"2026-02-07T11:00:47.82729966+11:00","created_by":"John Morrissey"}]}
{"id":"keisei-qwm.7","title":"P1-11: Fix blocking async in parallel_executor","description":"evaluation/core/parallel_executor.py — execute_games_parallel is declared async but blocks the event loop with synchronous concurrent.futures.as_completed iteration. Fix: Use asyncio-compatible pattern (loop.run_in_executor or asyncio.as_completed).","status":"closed","priority":1,"issue_type":"bug","owner":"544926+tachyon-beep@users.noreply.github.com","created_at":"2026-02-07T11:00:56.845925628+11:00","created_by":"John Morrissey","updated_at":"2026-02-07T17:04:42.741209056+11:00","closed_at":"2026-02-07T17:04:42.741209056+11:00","close_reason":"Closed","dependencies":[{"issue_id":"keisei-qwm.7","depends_on_id":"keisei-qwm","type":"parent-child","created_at":"2026-02-07T11:00:56.846841753+11:00","created_by":"John Morrissey"}]}
{"id":"keisei-r9s","title":"P1-06: Delete dead features.py build_core46 function","description":"shogi/features.py — build_core46 uses wrong attribute access patterns, wrong method calls, no perspective flip. Completely diverges from production shogi_game_io.py. Would crash if called. Maintenance trap. Fix: Delete the function entirely.","status":"closed","priority":1,"issue_type":"task","owner":"544926+tachyon-beep@users.noreply.github.com","created_at":"2026-02-07T10:59:57.561889814+11:00","created_by":"John Morrissey","updated_at":"2026-02-07T19:45:35.620710977+11:00","closed_at":"2026-02-07T19:45:35.620710977+11:00","close_reason":"Closed","dependencies":[{"issue_id":"keisei-r9s","depends_on_id":"keisei-7dh","type":"parent-child","created_at":"2026-02-07T11:02:24.472841245+11:00","created_by":"John Morrissey"}]}
{"id":"keisei-sgf","title":"session_manager.py: unsanitized run names, untyped params, retry loop — 0/6 fixed","description":"0/6 findings fixed. (1) No run name sanitization against directory traversal (P2-27, also in y28.5) (2) Untyped parameters: eval_config, result duck-typed with hasattr (3) WandB finalization retry loop with busy-wait (4) Session info logging bypasses property guard (5) Unused sys import (6) Internal 'Fix B5' tracking label in production code. See docs/code_analysis/keisei_training_session_manager.analysis.md","notes":"Finding 1 (unsanitized run names): FIXED. Finding 5 (unused sys): FIXED. Finding 6 (Fix B5 label): FIXED. Remaining: 2, 3, 4 deferred.","status":"closed","priority":3,"issue_type":"task","owner":"544926+tachyon-beep@users.noreply.github.com","created_at":"2026-02-08T05:56:21.760606655+11:00","created_by":"John Morrissey","updated_at":"2026-02-08T13:12:57.179784408+11:00","closed_at":"2026-02-08T13:12:57.179784408+11:00","close_reason":"Fixed 3 remaining findings: (2) Added EvaluationConfig type annotation to setup_evaluation_logging; (3) Replaced busy-wait retry loop in finalize_session with clean daemon thread + join(timeout=10); (4) Changed log_session_info to use run_artifact_dir property instead of bypassing guard via private _run_artifact_dir."}
{"id":"keisei-t65","title":"step_manager.py: dead _prepare_demo_info, 250-line execute_step — 0/6 fixed","description":"0/6 findings fixed. (1) Dead code: _prepare_demo_info (lines 536-561) never called (2) Duplicated reset logic between handle_episode_end and reset_episode (3) execute_step is ~250 lines handling 6+ responsibilities (4) Narrow ValueError-only exception handling (5) State inconsistency on agent failure (returns done=False with reset game but stale counters) (6) Silent failure on reset. See docs/code_analysis/keisei_training_step_manager.analysis.md","notes":"Finding 1 (dead _prepare_demo_info): FIXED - method deleted. Remaining: findings 2-6 deferred.","status":"closed","priority":3,"issue_type":"task","owner":"544926+tachyon-beep@users.noreply.github.com","created_at":"2026-02-08T05:56:11.055065644+11:00","created_by":"John Morrissey","updated_at":"2026-02-08T18:02:43.733307328+11:00","closed_at":"2026-02-08T18:02:43.733307328+11:00","close_reason":"Refactored step_manager.py: extracted 4 helpers (_obs_to_tensor, _clear_episode_counters, _track_move_stats, _reset_and_fail), deduplicated reset logic, broadened exception handling, reduced execute_step from ~250 to ~117 lines. 21 new tests added, all 38 unit + 11 caller + 54 integration tests pass."}
{"id":"keisei-uk4","title":"P2-06: Deduplicate observation constants","description":"shogi/shogi_core_definitions.py and constants.py — Same constants defined in two places with different names; drift risk.","status":"closed","priority":3,"issue_type":"task","owner":"544926+tachyon-beep@users.noreply.github.com","created_at":"2026-02-07T11:01:34.457297454+11:00","created_by":"John Morrissey","updated_at":"2026-02-07T23:18:45.52398982+11:00","closed_at":"2026-02-07T23:18:45.52398982+11:00","close_reason":"Removed 10 dead duplicate observation constants from constants.py. Canonical source is shogi_core_definitions.py.","dependencies":[{"issue_id":"keisei-uk4","depends_on_id":"keisei-7dh","type":"parent-child","created_at":"2026-02-07T11:03:20.465713958+11:00","created_by":"John Morrissey"}]}
{"id":"keisei-vu9","title":"neural_network.py: hardcoded 9x9 dims, inconsistent value shape, no type annotations","description":"0/3 findings fixed. (1) Lines 19-20 hardcode nn.Linear(16*9*9,...) instead of using SHOGI_BOARD_SQUARES constant (2) forward() returns value with shape (batch,1) not (batch,) — inconsistent with ResNet tower (3) forward() method lacks type annotations. See docs/code_analysis/keisei_core_neural_network.py.analysis.md","status":"closed","priority":3,"issue_type":"task","owner":"544926+tachyon-beep@users.noreply.github.com","created_at":"2026-02-08T05:55:37.739782489+11:00","created_by":"John Morrissey","updated_at":"2026-02-08T12:19:29.90153529+11:00","closed_at":"2026-02-08T12:19:29.90153529+11:00","close_reason":"All 3 findings fixed: use SHOGI_BOARD_SQUARES constant, add .squeeze(-1) for consistent value shape, add type annotations to forward()"}
{"id":"keisei-w72","title":"checkpoint.py: unused input_channels param, silent truncation, strict=False — 1/9 fixed","description":"1/9 findings fixed (state dict key detection works). Remaining: (1) Unused input_channels parameter (2) Stem key detection terminates on first match (3) Silent weight truncation with no warning (4) strict=False silently ignores key mismatches (5) Mutates input dict in-place as undocumented side effect (6) No error handling for missing stem key (7) No logging of pad/truncate operations. See docs/code_analysis/keisei_utils_checkpoint.analysis.md","status":"closed","priority":3,"issue_type":"task","owner":"544926+tachyon-beep@users.noreply.github.com","created_at":"2026-02-08T05:57:07.980263187+11:00","created_by":"John Morrissey","updated_at":"2026-02-08T18:45:37.358291201+11:00","closed_at":"2026-02-08T18:45:37.358291201+11:00","close_reason":"RC1 must-fix bugs addressed: WebUI host default, sennichite comments, checkpoint cleanup, CLI defaults, is_in_check corruption masking"}
{"id":"keisei-w74","title":"base_evaluator.py: error games as draws, arbitrary setattr, dead validate_config","description":"0/4 findings fixed. (1) Error games returned as GameResult(winner=None) counted as draws in SummaryStats (2) set_runtime_context uses arbitrary setattr from **kwargs with no restriction (3) Inconsistent logger: module-level vs instance-level used interchangeably (4) validate_config is dead code — always returns True, except handler unreachable. See docs/code_analysis/keisei_evaluation_core_base_evaluator.analysis.md","status":"closed","priority":3,"issue_type":"bug","owner":"544926+tachyon-beep@users.noreply.github.com","created_at":"2026-02-08T05:56:33.627563153+11:00","created_by":"John Morrissey","updated_at":"2026-02-08T13:00:35.216674185+11:00","closed_at":"2026-02-08T13:00:35.216674185+11:00","close_reason":"Already fixed: GameResult.is_draw checks 'error' not in metadata, SummaryStats.from_games() filters error games via is_error"}
{"id":"keisei-w7e","title":"P2-04: Fix KIF export multiple bugs","description":"shogi/shogi_game_io.py — Uses current hands instead of initial position; drops drop moves; non-standard notation format; termination_map case mismatch.","status":"closed","priority":3,"issue_type":"bug","owner":"544926+tachyon-beep@users.noreply.github.com","created_at":"2026-02-07T11:01:17.207931553+11:00","created_by":"John Morrissey","updated_at":"2026-02-08T01:06:27.590767616+11:00","closed_at":"2026-02-08T01:06:27.590767616+11:00","close_reason":"Fixed 4 KIF bugs: initial hands now empty for HIRATE, drop moves included via encode_move_to_sfen_string, termination_map keys match enum values.","dependencies":[{"issue_id":"keisei-w7e","depends_on_id":"keisei-7dh","type":"parent-child","created_at":"2026-02-07T11:03:10.28867677+11:00","created_by":"John Morrissey"}]}
{"id":"keisei-w8a","title":"REGRESSION P1-04: Inverted recency bonus still present in enhanced_manager.py","description":"keisei-qwm.5 was closed but audit confirms issue is STILL PRESENT. evaluation/opponents/enhanced_manager.py:351 — recency_bonus formula gives HIGHER bonus to MORE recently played opponents (small games_since_last_played), contradicting comment 'Bonus for less recently played opponents'. The formula 1.0 - 1.0/(1.0 + data.games_since_last_played/10.0) is monotonically increasing, so larger gaps get larger bonuses — which is correct for the stated intent. VERIFY: the agent report may have misread the math. If truly inverted, fix the formula.","status":"closed","priority":1,"issue_type":"bug","owner":"544926+tachyon-beep@users.noreply.github.com","created_at":"2026-02-08T05:55:19.96088156+11:00","created_by":"John Morrissey","updated_at":"2026-02-08T11:51:30.149411931+11:00","closed_at":"2026-02-08T11:51:30.149411931+11:00","close_reason":"Verified: formula is CORRECT. recency_bonus = 1.0 - 1.0/(1.0 + games_since_last_played/10.0) is monotonically increasing with games_since_last_played, giving higher bonus to less recently played opponents as intended. Original audit misread the math."}
{"id":"keisei-x3d","title":"Config schema validation gaps: 15 unaddressed findings in config_schema.py","description":"config_schema.py has 15 findings from code analysis with 0 fixed. Key issues: (1) Duplicate evaluation_interval_timesteps in TrainingConfig and EvaluationConfig (2) WebUIConfig defaults to host 0.0.0.0 with no auth docs (3) EnvConfig lacks field validators (4) model_type is unvalidated string, not Literal/Enum (5) strategy_params is untyped dict (6) Sub-models lack extra=forbid (7) EvaluationStrategy is plain class not Enum (8) max_moves_per_game duplicated without cross-validation (9) steps_per_epoch/minibatch_size no divisibility check. See docs/code_analysis/keisei_config_schema.py.analysis.md for full list.","status":"closed","priority":3,"issue_type":"task","owner":"544926+tachyon-beep@users.noreply.github.com","created_at":"2026-02-08T05:55:27.897427837+11:00","created_by":"John Morrissey","updated_at":"2026-02-08T18:45:37.345756141+11:00","closed_at":"2026-02-08T18:45:37.345756141+11:00","close_reason":"RC1 must-fix bugs addressed: WebUI host default, sennichite comments, checkpoint cleanup, CLI defaults, is_in_check corruption masking"}
{"id":"keisei-xh2","title":"constants.py: test constants mixed with production, FULL_ACTION_SPACE not linked to config","description":"3/8 findings fixed (duplicate TEST_BATCH_SIZE removed, OBS constants deduped, dead GameTerminationReason removed). Remaining: (1) FULL_ACTION_SPACE/ALTERNATIVE_ACTION_SPACE not linked to config_schema num_actions_total (2) 60%+ of file is TEST_* constants mixed with production (3) Empty section headers (4) LOG_FILE_EXTENSION .log vs config uses .txt. See docs/code_analysis/keisei_constants.py.analysis.md","status":"open","priority":4,"issue_type":"task","owner":"544926+tachyon-beep@users.noreply.github.com","created_at":"2026-02-08T05:55:40.357925728+11:00","created_by":"John Morrissey","updated_at":"2026-02-08T05:55:40.357925728+11:00"}
{"id":"keisei-y28","title":"Sprint 5: Technical Debt","description":"Code duplication, dead code cleanup, triple Elo consolidation, missing type annotations, and minor issues. P2-11 through P2-28 and all P3 items.","status":"open","priority":3,"issue_type":"epic","owner":"544926+tachyon-beep@users.noreply.github.com","created_at":"2026-02-07T10:59:52.178153491+11:00","created_by":"John Morrissey","updated_at":"2026-02-07T10:59:52.178153491+11:00","dependencies":[{"issue_id":"keisei-y28","depends_on_id":"keisei-7dh","type":"blocks","created_at":"2026-02-07T11:04:23.443218869+11:00","created_by":"John Morrissey"}]}
{"id":"keisei-y28.1","title":"P2-11..14: Fix evaluation tracking and metrics issues","description":"P2-11: Dead Elo tracking in enhanced_manager.py (elo_rating never updated). P2-12: Display refresh iterates model parameters at 4Hz (GPU-CPU transfer). P2-13: Incomplete checkpoint restore in metrics_manager.py (trend data, Elo lost on resume). P2-14: Non-thread-safe processing flag in metrics_manager.py.","notes":"P2-11 (dead Elo tracking): FIXED - added _update_elo_estimate() to OpponentPerformanceData.update_with_result(). P2-12 (display refresh 4Hz): FIXED in Streamlit refactor (display.py deleted). P2-13 (incomplete checkpoint restore) and P2-14 (thread-safe flag): deferred to later sprint.","status":"open","priority":3,"issue_type":"bug","owner":"544926+tachyon-beep@users.noreply.github.com","created_at":"2026-02-07T11:00:03.809972547+11:00","created_by":"John Morrissey","updated_at":"2026-02-08T12:16:56.949206996+11:00","dependencies":[{"issue_id":"keisei-y28.1","depends_on_id":"keisei-y28","type":"parent-child","created_at":"2026-02-07T11:00:03.81118106+11:00","created_by":"John Morrissey"}]}
{"id":"keisei-y28.2","title":"P2-15..16: Fix hardcoded dimensions and memory waste","description":"P2-15: Hard-coded tensor dimensions (46,9,9) and (13527) in experience_buffer.py instead of parameterized. P2-16: Weight cloning for UI doubles peak memory in trainer.py:266-284.","status":"closed","priority":3,"issue_type":"task","owner":"544926+tachyon-beep@users.noreply.github.com","created_at":"2026-02-07T11:00:13.503341934+11:00","created_by":"John Morrissey","updated_at":"2026-02-08T03:14:52.969789203+11:00","closed_at":"2026-02-08T03:14:52.969789203+11:00","close_reason":"P2-15: Parameterized ExperienceBuffer dimensions (obs_channels, board_size, num_actions) with constants as defaults. P2-16: Weight cloning for UI now conditional on webui_manager being enabled.","dependencies":[{"issue_id":"keisei-y28.2","depends_on_id":"keisei-y28","type":"parent-child","created_at":"2026-02-07T11:00:13.50421041+11:00","created_by":"John Morrissey"}]}
{"id":"keisei-y28.3","title":"P2-17..19: Fix config and profiling issues","description":"P2-17: Hardcoded dummy config in agent_loading.py:48-170 (120-line AppConfig, architecture mismatch risk). P2-18: CLI defaults override config in train.py (argparse defaults for strategy/num_games/opponent_type always override config). P2-19: Profiling unbounded memory growth in profiling.py (~40MB for 1M-step run).","status":"closed","priority":3,"issue_type":"bug","owner":"544926+tachyon-beep@users.noreply.github.com","created_at":"2026-02-07T11:00:23.833371608+11:00","created_by":"John Morrissey","updated_at":"2026-02-08T18:45:37.354813109+11:00","closed_at":"2026-02-08T18:45:37.354813109+11:00","close_reason":"RC1 must-fix bugs addressed: WebUI host default, sennichite comments, checkpoint cleanup, CLI defaults, is_in_check corruption masking","dependencies":[{"issue_id":"keisei-y28.3","depends_on_id":"keisei-y28","type":"parent-child","created_at":"2026-02-07T11:00:23.834233321+11:00","created_by":"John Morrissey"}]}
{"id":"keisei-y28.4","title":"P2-20..24: Fix WebUI and parallel worker issues","description":"P2-20: SO_REUSEADDR set after bind in web_server.py:97 (no effect). P2-21: WebUI max_connections=10 never enforced. P2-22: WebUI panels reference nonexistent attributes, display fabricated data. P2-23: Parallel worker silently drops experience when queues full. P2-24: No worker restart mechanism in parallel_manager.py.","notes":"P2-20 (SO_REUSEADDR): FIXED (commit 7bed286). P2-21 (max_connections): OBSOLETE - Streamlit refactor removed connection model. P2-22 (WebUI fabricated data): FIXED - streamlit_app.py uses .get() with defaults. P2-23 (parallel worker silent drops): deferred. P2-24 (worker restart): deferred.","status":"open","priority":3,"issue_type":"bug","owner":"544926+tachyon-beep@users.noreply.github.com","created_at":"2026-02-07T11:00:34.081042578+11:00","created_by":"John Morrissey","updated_at":"2026-02-08T12:16:59.344843422+11:00","dependencies":[{"issue_id":"keisei-y28.4","depends_on_id":"keisei-y28","type":"parent-child","created_at":"2026-02-07T11:00:34.082057629+11:00","created_by":"John Morrissey"}]}
{"id":"keisei-y28.5","title":"P2-25..28: Fix evaluation and training infrastructure issues","description":"P2-25: evaluation/core/model_manager.py staged as deleted but still imported. P2-26: run_async()/run() ~100 lines duplicated in training_loop_manager.py. P2-27: User-controlled run names unsanitized in paths (session_manager.py:120). P2-28: Dangerous decompression fallback in parallel/utils.py (can return 0-dim array).","notes":"P2-25 (model_manager.py deleted): FALSE POSITIVE - file exists. P2-27 (unsanitized run names): FIXED - added _sanitize_run_name() to SessionManager. P2-28 (decompression fallback): FIXED - re-raise instead of returning corrupt data. P2-26 (run/run_async duplication): deferred refactoring.","status":"open","priority":3,"issue_type":"bug","owner":"544926+tachyon-beep@users.noreply.github.com","created_at":"2026-02-07T11:00:45.405713479+11:00","created_by":"John Morrissey","updated_at":"2026-02-08T12:17:01.740680242+11:00","dependencies":[{"issue_id":"keisei-y28.5","depends_on_id":"keisei-y28","type":"parent-child","created_at":"2026-02-07T11:00:45.406564923+11:00","created_by":"John Morrissey"}]}
{"id":"keisei-y28.6","title":"P3: Dead code cleanup","description":"Remove dead code across codebase: dead GameTerminationReason class, dead OBS constants, build_core46 (if not already removed in Sprint 4), test/dummy FeatureSpec entries, _pad_symbol no-op, _handle_checkpoint_resume never called, _prepare_demo_info never called, previous_model_selector.py unused, parallel model_sync functions never called, communication._shared_model_data unused, validate_config always-true, PerformanceGuard unused, evaluate_step_in_memory no-op, create_compilation_decorator never invokes validator, _timer_context unused.","status":"closed","priority":4,"issue_type":"task","owner":"544926+tachyon-beep@users.noreply.github.com","created_at":"2026-02-07T11:00:58.282848313+11:00","created_by":"John Morrissey","updated_at":"2026-02-08T03:14:52.946652425+11:00","closed_at":"2026-02-08T03:14:52.946652425+11:00","close_reason":"Removed dead code: GameTerminationReason class, PerformanceGuard class, create_compilation_decorator function, _timer_context method, _shared_model_data attribute. Also removed test for deleted _pad_symbol.","dependencies":[{"issue_id":"keisei-y28.6","depends_on_id":"keisei-y28","type":"parent-child","created_at":"2026-02-07T11:00:58.284078316+11:00","created_by":"John Morrissey"}]}
{"id":"keisei-y28.7","title":"P3: Code duplication cleanup","description":"Reduce code duplication: _format_hand duplicated in display_components.py, ~260 lines game-loop code across 4 eval strategies, eval interval alignment tripled in callback_manager.py, run()/run_async() ~80pct identical in training_loop_manager.py, save_checkpoint/save_final_checkpoint/save_final_model ~60 lines duplicated, move formatting code ~80pct duplicated.","status":"open","priority":4,"issue_type":"task","owner":"544926+tachyon-beep@users.noreply.github.com","created_at":"2026-02-07T11:01:09.377645339+11:00","created_by":"John Morrissey","updated_at":"2026-02-07T11:01:09.377645339+11:00","dependencies":[{"issue_id":"keisei-y28.7","depends_on_id":"keisei-y28","type":"parent-child","created_at":"2026-02-07T11:01:09.378454534+11:00","created_by":"John Morrissey"}]}
{"id":"keisei-y28.8","title":"P3: Consolidate triple Elo implementation","description":"Three independent Elo implementations with slightly different math: training/elo_rating.py (self-play), evaluation/analytics/elo_tracker.py (analytics), evaluation/opponents/elo_registry.py (opponent tracking). Consolidate to single shared implementation.","status":"open","priority":4,"issue_type":"task","owner":"544926+tachyon-beep@users.noreply.github.com","created_at":"2026-02-07T11:01:18.578990617+11:00","created_by":"John Morrissey","updated_at":"2026-02-07T11:01:18.578990617+11:00","dependencies":[{"issue_id":"keisei-y28.8","depends_on_id":"keisei-y28","type":"parent-child","created_at":"2026-02-07T11:01:18.580182047+11:00","created_by":"John Morrissey"}]}
{"id":"keisei-y28.9","title":"P3: Minor code quality issues","description":"Unused imports (asyncio, sys, signal, torch.profiler, ActorCriticProtocol in various files). Missing type annotations in setup_manager.py, session_manager.py, utils.py. Minor issues: DisplayComponent protocol unused, MultiMetricSparkline unbounded growth, TerminalInfo.unicode_ok unused, debug border colors, inconsistent rate units, format_ppo_metrics side effect, log_error_to_stderr used for success, error games counted as draws, sys.path.insert at module level, is_in_check masks corruption.","status":"closed","priority":4,"issue_type":"task","owner":"544926+tachyon-beep@users.noreply.github.com","created_at":"2026-02-07T11:01:30.898667036+11:00","created_by":"John Morrissey","updated_at":"2026-02-08T03:14:52.923044774+11:00","closed_at":"2026-02-08T03:14:52.923044774+11:00","close_reason":"Removed unused imports (sys in ppo_agent.py and training/utils.py, signal in web_server.py), removed unused DisplayComponent protocol, removed _pad_symbol no-op, removed unused TerminalInfo.unicode_ok field, fixed MultiMetricSparkline unbounded growth with deque(maxlen=width).","dependencies":[{"issue_id":"keisei-y28.9","depends_on_id":"keisei-y28","type":"parent-child","created_at":"2026-02-07T11:01:30.900278674+11:00","created_by":"John Morrissey"}]}
{"id":"keisei-y9w","title":"performance_benchmarker.py: unused torch.profiler import, gc.collect overhead — 0/4 fixed","description":"0/4 findings fixed. (1) Unused torch.profiler imports (profile, ProfilerActivity) (2) gc.collect() called per-iteration in benchmark loop adds overhead to measurements (3) model.eval() side effect never restored (4) No error handling for forward pass in benchmark loop. See docs/code_analysis/keisei_utils_performance_benchmarker.analysis.md","status":"closed","priority":4,"issue_type":"task","owner":"544926+tachyon-beep@users.noreply.github.com","created_at":"2026-02-08T05:57:27.884241205+11:00","created_by":"John Morrissey","updated_at":"2026-02-08T12:07:12.894956741+11:00","closed_at":"2026-02-08T12:07:12.894956741+11:00","close_reason":"Removed unused torch.profiler imports. benchmark_model() now saves/restores model.training mode."}
{"id":"keisei-zyg","title":"evaluation/core/__init__.py: imports from deleted model_manager, type mismatch — 0/4 fixed","description":"0/4 findings fixed. (1) Line 22 imports from model_manager.py which P2-25 notes is staged as deleted (2) random_seed: int = None — type hint contradicts default (3) Parameter aliasing: wandb_logging mapped to wandb_log_eval (4) Parameter aliasing: opponent_name mapped to opponent_type. See docs/code_analysis/keisei_evaluation_core___init__.analysis.md","status":"closed","priority":2,"issue_type":"bug","owner":"544926+tachyon-beep@users.noreply.github.com","created_at":"2026-02-08T05:56:56.294224188+11:00","created_by":"John Morrissey","updated_at":"2026-02-08T12:00:00.445103925+11:00","closed_at":"2026-02-08T12:00:00.445103925+11:00","close_reason":"Finding 1 (deleted model_manager.py) was false — file exists. Findings 3/4 (parameter aliasing) are intentional convenience factory design. Fixed finding 2: corrected type hints random_seed: int -\u003e Optional[int] and save_path: str -\u003e Optional[str]. Added typing import."}
